{
    "type": [
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2
    ],
    "data": [
        "    print(\"The residuals are not numeric.\")",
        "+ ",
        "  }",
        "+ ",
        "  ",
        "+ ",
        "  # Check homogeneity of variances using Levene's test",
        "+ ",
        "  levene_test <- car::leveneTest(residuals ~ fitted(anova_results))",
        "+ ",
        "  print(levene_test)",
        "+ ",
        "  ",
        "+ ",
        "  # Check normality of residuals using Shapiro-Wilk test",
        "+ ",
        "  shapiro_test <- shapiro.test(residuals)",
        "+ ",
        "  print(shapiro_test)",
        "+ ",
        "  ",
        "+ ",
        "  # Plot homogeneity of variances",
        "+ ",
        "  plot_homogeneity <- ggplot(data.frame(Residuals = residuals), aes(y = Residuals)) +",
        "+ ",
        "    geom_boxplot() +",
        "+ ",
        "    labs(title = \"Homogeneity of Variances\", y = \"Residuals\") +",
        "+ ",
        "    theme_minimal()",
        "+ ",
        "  print(plot_homogeneity)",
        "+ ",
        "  ",
        "+ ",
        "  # Plot normal Q-Q plot of the residuals",
        "+ ",
        "  qq_plot <- qqnorm(residuals, main = \"Normal Q-Q Plot of Residuals\")",
        "+ ",
        "  qq_line <- qqline(residuals)",
        "+ ",
        "  print(qq_plot)",
        "+ ",
        "}",
        "> ",
        "",
        "> ",
        "two_way_anova_results <- run_two_way_anova(Satiety_long, question = \"S1\")",
        "\nError: Participant\n          Df Sum Sq Mean Sq F value Pr(>F)\nResiduals 38 217193    5716               \n\nError: Participant:Timepoint\n           Df Sum Sq Mean Sq F value Pr(>F)    \nTimepoint  10 210890   21089   76.06 <2e-16 ***\nResiduals 380 105368     277                   \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nError: Within\n                        Df Sum Sq Mean Sq F value Pr(>F)    \nIntervention             1  16945   16945   80.87 <2e-16 ***\nIntervention:Timepoint",
        "  10   1886     189    0.90  0.533    \nResiduals              418  87583     210                   \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "source(file = \"../R/HUEL_satiety_functions.R\")",
        "> ",
        "",
        "> ",
        "check_anova_assumptions(anova_results_S1)",
        "[1] \"There are no missing values in the residuals.\"\n[1] \"The residuals are numeric.\"\n",
        "Error in model.frame.default(form) : \n  invalid type (NULL) for variable 'fitted(anova_results)'\n",
        "> ",
        "# Function to check ANOVA assumptions",
        "> ",
        "check_anova_assumptions <- function(anova_results) {",
        "+ ",
        "  # Extract residuals from ANOVA results",
        "+ ",
        "  residuals <- as.numeric(resid(anova_results))",
        "+ ",
        "  ",
        "+ ",
        "  # Check if there are any missing values in the residuals",
        "+ ",
        "  if (any(is.na(residuals))) {",
        "+ ",
        "    print(\"There are missing values in the residuals.\")",
        "+ ",
        "  } else {",
        "+ ",
        "    print(\"There are no missing values in the residuals.\")",
        "+ ",
        "  }",
        "+ ",
        "  ",
        "+ ",
        "  # Check if the residuals are numeric",
        "+ ",
        "  if (is.numeric(residuals)) {",
        "+ ",
        "    print(\"The residuals are numeric.\")",
        "+ ",
        "  } else {",
        "+ ",
        "    print(\"The residuals are not numeric.\")",
        "+ ",
        "  }",
        "+ ",
        "  ",
        "+ ",
        "  # Check homogeneity of variances using Levene's test",
        "+ ",
        "  levene_test <- car::leveneTest(residuals ~ rep(1, length(residuals)))",
        "+ ",
        "  print(levene_test)",
        "+ ",
        "  ",
        "+ ",
        "  # Check normality of residuals using Shapiro-Wilk test",
        "+ ",
        "  shapiro_test <- shapiro.test(residuals)",
        "+ ",
        "  print(shapiro_test)",
        "+ ",
        "  ",
        "+ ",
        "  # Plot homogeneity of variances",
        "+ ",
        "  plot_homogeneity <- ggplot(data.frame(Residuals = residuals), aes(y = Residuals)) +",
        "+ ",
        "    geom_boxplot() +",
        "+ ",
        "    labs(title = \"Homogeneity of Variances\", y = \"Residuals\") +",
        "+ ",
        "    theme_minimal()",
        "+ ",
        "  print(plot_homogeneity)",
        "+ ",
        "  ",
        "+ ",
        "  # Plot normal Q-Q plot of the residuals",
        "+ ",
        "  qq_plot <- qqnorm(residuals, main = \"Normal Q-Q Plot of Residuals\")",
        "+ ",
        "  qq_line <- qqline(residuals)",
        "+ ",
        "  print(qq_plot)",
        "+ ",
        "}",
        "> ",
        "",
        "> ",
        "check_anova_assumptions(anova_results_S1)",
        "[1] \"There are no missing values in the residuals.\"\n[1] \"The residuals are numeric.\"\n",
        "Error in leveneTest.formula(residuals ~ rep(1, length(residuals))) : \n  Levene's test is not appropriate with quantitative explanatory variables.\n",
        "> ",
        "S1_subset_data <- filter(Satiety_long, Question == \"S1\")",
        "> ",
        "View(S1_subset_data)",
        "> ",
        "S1_anova_results <- aov(Measurement ~ Intervention * Timepoint + Error(Participant/Timepoint), data = S1_subset_data)",
        "> ",
        "",
        "> ",
        "print(summary(S1_anova_results))",
        "\nError: Participant\n          Df Sum Sq Mean Sq F value Pr(>F)\nResiduals 38 217193    5716               \n\nError: Participant:Timepoint\n           Df Sum Sq Mean Sq F value Pr(>F)    \nTimepoint  10 210890   21089   76.06 <2e-16 ***\nResiduals 380 105368     277                   \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nError: Within\n                        Df Sum Sq Mean Sq F value Pr(>F)    \nIntervention             1  16945   16945   80.87 <2e-16 ***\nIntervention:Timepoint",
        "  10   1886     189    0.90  0.533    \nResiduals              418  87583     210                   \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n",
        "> ",
        "",
        "> ",
        "S1_anova_results <- aov(Measurement ~ Intervention * Timepoint , data = S1_subset_data)",
        "> ",
        "",
        "> ",
        "print(summary(S1_anova_results))",
        "                        Df Sum Sq Mean Sq F value   Pr(>F)    \nIntervention             1  16945   16945  34.540 6.03e-09 ***\nTimepoint               10 210890   21089  42.986  < 2e-16 ***\nIntervention:Timepoint  10   1886     189   0.384    0.954    \nResiduals              836 410144     491                     \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n22 observations deleted due to missingness\n",
        "> ",
        "",
        "> ",
        "shapiro.test(resid(S1_anova_results))",
        "\n\tShapiro-Wilk normality test\n\ndata:  resid(S1_anova_results)\nW = 0.9928, p-value = 0.0003635\n\n",
        "> ",
        "",
        "> ",
        "two_way_anova_results <- run_two_way_anova(Satiety_long, question = \"S1\")",
        "\nError: Participant\n          Df Sum Sq Mean Sq F value Pr(>F)\nResiduals 38 217193    5716               \n\nError: Participant:Timepoint\n           Df Sum Sq Mean Sq F value Pr(>F)    \nTimepoint  10 210890   21089   76.06 <2e-16 ***\nResiduals 380 105368     277                   \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nError: Within\n                        Df Sum Sq Mean Sq F value Pr(>F)    \nIntervention             1  16945   16945   80.87 <2e-16 ***\nIntervention:Timepoint",
        "  10   1886     189    0.90  0.533    \nResiduals              418  87583     210                   \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n",
        "> ",
        "shapiro.test(resid(S1_anova_results))",
        "\n\tShapiro-Wilk normality test\n\ndata:  resid(S1_anova_results)\nW = 0.9928, p-value = 0.0003635\n\n",
        "> ",
        "",
        "> ",
        "levene_test <- leveneTest(resid(S1_anova_results))",
        "Error in leveneTest.default(resid(S1_anova_results)) : \n  argument \"group\" is missing, with no default\n",
        "> ",
        "plot_homogeneity <- ggplot(data.frame(Residuals = resid(S1_anova_results)), aes(y = Residuals)) +",
        "+ ",
        "  geom_boxplot() +",
        "+ ",
        "  labs(title = \"Homogeneity of Variances\", y = \"Residuals\") +",
        "+ ",
        "  theme_minimal()",
        "> ",
        "print(plot_homogeneity)",
        "> ",
        "print(plot_homogeneity)",
        "> ",
        "",
        "> ",
        "levene_test <- leveneTest(resid(S1_anova_results))",
        "Error in leveneTest.default(resid(S1_anova_results)) : \n  argument \"group\" is missing, with no default\n",
        "> ",
        "qq_plot <- qqnorm(resid(S1_anova_results), main = \"Normal Q-Q Plot of Residuals\")",
        "> ",
        "qq_line <- qqline(resid(S1_anova_results))",
        "> ",
        "qq_line <- qqline(resid(S1_anova_results))",
        "Error in int_abline(a = a, b = b, h = h, v = v, untf = untf, ...) : \n  plot.new has not been called yet\n",
        "> ",
        "qq_plot <- qqnorm(resid(S1_anova_results), main = \"Normal Q-Q Plot of Residuals\")",
        "> ",
        "qq_line <- qqline(resid(S1_anova_results))",
        "> ",
        "levene_test <- leveneTest(resid(S1_anova_results))",
        "Error in leveneTest.default(resid(S1_anova_results)) : \n  argument \"group\" is missing, with no default\n",
        "> ",
        "group <- rep(1, length(resid(S1_anova_results)))",
        "> ",
        "",
        "> ",
        "# Perform Levene's test",
        "> ",
        "levene_test <- leveneTest(resid(S1_anova_results) ~ group)",
        "Error in leveneTest.formula(resid(S1_anova_results) ~ group) : \n  Levene's test is not appropriate with quantitative explanatory variables.\n",
        "> ",
        "leveneTest(Measurement ~ Intervention * Timepoint + Error(Participant/Timepoint), data = S1_subset_data)",
        "Error in Error(Participant/Timepoint) : could not find function \"Error\"\n",
        "> ",
        "leveneTest(Measurement ~ Intervention * Timepoint, data = S1_subset_data)",
        "Levene's Test for Homogeneity of Variance (center = median)\n       Df F value Pr(>F)\ngroup  21  1.1252 0.3146\n      836               \n",
        "> ",
        "",
        "> ",
        "plot_homogeneity <- ggplot(data.frame(Residuals = resid(S1_anova_results)), aes(y = Residuals)) +",
        "+ ",
        "  geom_boxplot() +",
        "+ ",
        "  labs(title = \"Homogeneity of Variances\", y = \"Residuals\") +",
        "+ ",
        "  theme_minimal()",
        "> ",
        "print(plot_homogeneity)",
        "> ",
        "",
        "> ",
        "#| layout-ncol: 2",
        "> ",
        "",
        "> ",
        "#Check assumptions",
        "> ",
        "",
        "> ",
        "leveneTest(Measurement ~ Intervention * Timepoint, data = S1_subset_data)",
        "Levene's Test for Homogeneity of Variance (center = median)\n       Df F value Pr(>F)\ngroup  21  1.1252 0.3146\n      836               \n",
        "> ",
        "",
        "> ",
        "plot_homogeneity <- ggplot(data.frame(Residuals = resid(S1_anova_results)), aes(y = Residuals)) +",
        "+ ",
        "  geom_boxplot() +",
        "+ ",
        "  labs(title = \"Homogeneity of Variances\", y = \"Residuals\") +",
        "+ ",
        "  theme_minimal()",
        "> ",
        "print(plot_homogeneity)",
        "> ",
        "",
        "> ",
        "qq_plot <- qqnorm(resid(S1_anova_results), main = \"Normal Q-Q Plot of Residuals\")",
        "> ",
        "qq_line <- qqline(resid(S1_anova_results))",
        "> ",
        "",
        "> ",
        "shapiro.test(resid(S1_anova_results))",
        "\n\tShapiro-Wilk normality test\n\ndata:  resid(S1_anova_results)\nW = 0.9928, p-value = 0.0003635\n\n",
        "> ",
        "",
        "> ",
        "library(readxl)",
        "> ",
        "library(tidyverse)",
        "> ",
        "library(patchwork)",
        "> ",
        "library(hrbrthemes)",
        "> ",
        "library(DT)",
        "> ",
        "library(knitr)",
        "> ",
        "library(plotly)",
        "> ",
        "library(tidyr)",
        "> ",
        "library(dplyr)",
        "> ",
        "library(car)",
        "> ",
        "# Read the cleaned Satiety Study",
        "> ",
        "",
        "> ",
        "Satiety <- read_excel(\"../Input/HUEL_satiety_input.xlsx\")",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "#load function",
        "> ",
        "source(file = \"../R/HUEL_satiety_functions.R\")",
        "> ",
        "",
        "> ",
        "# Create an interactive table",
        "> ",
        "",
        "> ",
        "datatable(Satiety, filter = \"top\")",
        "> ",
        "",
        "> ",
        "# create mean +- SD table for HUEL and Cornflakes S1, 0 to 240 minutes",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "result_huel_s1 <- calculate_mean_sd(Satiety, intervention = \"HUEL\", question = \"S1\")",
        "> ",
        "result_cornflakes_s1 <- calculate_mean_sd(Satiety, intervention = \"Cornflakes\", question = \"S1\")",
        "> ",
        "",
        "> ",
        "combine_and_display_results(result_huel_s1, result_cornflakes_s1)",
        "> ",
        "",
        "> ",
        "# create a long format",
        "> ",
        "",
        "> ",
        "Satiety_long <- Satiety %>%",
        "+ ",
        "    pivot_longer(cols = starts_with(\"HUEL_\") | starts_with(\"Cornflakes_\"), names_to = \"Timepoint\", values_to = \"Measurement\")",
        "> ",
        "",
        "> ",
        "# Create Intervention column based on Timepoint",
        "> ",
        "Satiety_long <- Satiety_long %>%",
        "+ ",
        "  mutate(Intervention = ifelse(str_detect(Timepoint, \"^HUEL\"), \"HUEL\", \"Cornflakes\"),",
        "+ ",
        "         Timepoint = gsub(\"^HUEL_|^Cornflakes_\", \"\", Timepoint),",
        "+ ",
        "         Question = gsub(\"_.*\", \"\", Timepoint),",
        "+ ",
        "         Timepoint = gsub(\"^S\\\\d+_\", \"\", Timepoint))",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "#Subset the question",
        "> ",
        "",
        "> ",
        "S1_subset_data <- filter(Satiety_long, Question == \"S1\")",
        "> ",
        "",
        "> ",
        "# 2 way ANOVA",
        "> ",
        "",
        "> ",
        "S1_anova_results <- aov(Measurement ~ Intervention * Timepoint + Error(Participant/Timepoint), data = S1_subset_data)",
        "> ",
        "",
        "> ",
        "print(summary(S1_anova_results))",
        "\nError: Participant\n          Df Sum Sq Mean Sq F value Pr(>F)\nResiduals 38 217193    5716               \n\nError: Participant:Timepoint\n           Df Sum Sq Mean Sq F value Pr(>F)    \nTimepoint  10 210890   21089   76.06 <2e-16 ***\nResiduals 380 105368     277                   \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nError: Within\n                        Df Sum Sq Mean Sq F value Pr(>F)    \nIntervention             1  16945   16945   80.87 <2e-16 ***\nIntervention:Timepoint",
        "  10   1886     189    0.90  0.533    \nResiduals              418  87583     210                   \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "#| layout-ncol: 2",
        "> ",
        "",
        "> ",
        "#Check assumptions",
        "> ",
        "",
        "> ",
        "leveneTest(Measurement ~ Intervention * Timepoint, data = S1_subset_data)",
        "Levene's Test for Homogeneity of Variance (center = median)\n       Df F value Pr(>F)\ngroup  21  1.1252 0.3146\n      836               \n",
        "> ",
        "",
        "> ",
        "plot_homogeneity <- ggplot(data.frame(Residuals = resid(S1_anova_results)), aes(y = Residuals)) +",
        "+ ",
        "  geom_boxplot() +",
        "+ ",
        "  labs(title = \"Homogeneity of Variances\", y = \"Residuals\") +",
        "+ ",
        "  theme_minimal()",
        "> ",
        "print(plot_homogeneity)",
        "\u001B[1m\u001B[33mError\u001B[39m in `geom_boxplot()`:\u001B[22m\n\u001B[38;5;232m\u001B[33m!\u001B[38;5;232m Problem while computing aesthetics.\n\u001B[36mℹ\u001B[38;5;232m Error occurred in the 1st layer.\u001B[39m\n\u001B[1mCaused by error:\u001B[22m\n\u001B[33m!\u001B[39m object 'Residuals' not found\nBacktrace:\n\u001B[90m  1. \u001B[39m\u001B[1mbase\u001B[22m::print(plot_homogeneity)\n\u001B[90m  2. \u001B[39mggplot2:::print.ggplot(plot_homogeneity)\n\u001B[90m  4. \u001B[39mggplot2:::ggplot_build.ggplot(x)\n\u001B[90m  5. \u001B[39mggplot2:::by_layer(...)\n\u001B[90m 12. \u001B[39mggplot2 (local) f(l = layers[[i]], d = data[[i]])\n\u001B[90m 13. \u001B[39ml$compute_aesthetics(d, plot)\n\u001B[90m 14. \u001B[39mggplot2 (local) compute_aesthetics(..., self = self)\n\u001B[90m 15. \u001B[39mggplot2:::scales_add_defaults(...)\n\u001B[90m 16. \u001B[39m\u001B[1mbase\u001B[22m::lapply(aesthetics[new_aesthetics], eval_tidy, data = data)\n\u001B[90m 17. \u001B[39m\u001B[1mrlang\u001B[22m (local) FUN(X[[i]], ...)\n",
        "> ",
        "plot_homogeneity <- ggplot(data.frame(Residuals = resid(S1_anova_results)), aes(y = Residuals)) +",
        "+ ",
        "  geom_boxplot() +",
        "+ ",
        "  labs(title = \"Homogeneity of Variances\", y = \"Residuals\") +",
        "+ ",
        "  theme_minimal()",
        "> ",
        "print(plot_homogeneity)",
        "\u001B[1m\u001B[33mError\u001B[39m in `geom_boxplot()`:\u001B[22m\n\u001B[38;5;232m\u001B[33m!\u001B[38;5;232m Problem while computing aesthetics.\n\u001B[36mℹ\u001B[38;5;232m Error occurred in the 1st layer.\u001B[39m\n\u001B[1mCaused by error:\u001B[22m\n\u001B[33m!\u001B[39m object 'Residuals' not found\nBacktrace:\n\u001B[90m  1. \u001B[39m\u001B[1mbase\u001B[22m::print(plot_homogeneity)\n\u001B[90m  2. \u001B[39mggplot2:::print.ggplot(plot_homogeneity)\n\u001B[90m  4. \u001B[39mggplot2:::ggplot_build.ggplot(x)\n\u001B[90m  5. \u001B[39mggplot2:::by_layer(...)\n\u001B[90m 12. \u001B[39mggplot2 (local) f(l = layers[[i]], d = data[[i]])\n\u001B[90m 13. \u001B[39ml$compute_aesthetics(d, plot)\n\u001B[90m 14. \u001B[39mggplot2 (local) compute_aesthetics(..., self = self)\n\u001B[90m 15. \u001B[39mggplot2:::scales_add_defaults(...)\n\u001B[90m 16. \u001B[39m\u001B[1mbase\u001B[22m::lapply(aesthetics[new_aesthetics], eval_tidy, data = data)\n\u001B[90m 17. \u001B[39m\u001B[1mrlang\u001B[22m (local) FUN(X[[i]], ...)\n",
        "> ",
        "plot_homogeneity <- ggplot(data.frame(Residuals = resid(S1_anova_results)), aes(y = Residuals)) +",
        "+ ",
        "  geom_boxplot() +",
        "+ ",
        "  labs(title = \"Homogeneity of Variances\", y = \"Residuals\") +",
        "+ ",
        "  theme_minimal()",
        "> ",
        "print(plot_homogeneity)",
        "\u001B[1m\u001B[33mError\u001B[39m in `geom_boxplot()`:\u001B[22m\n\u001B[38;5;232m\u001B[33m!\u001B[38;5;232m Problem while computing aesthetics.\n\u001B[36mℹ\u001B[38;5;232m Error occurred in the 1st layer.\u001B[39m\n\u001B[1mCaused by error:\u001B[22m\n\u001B[33m!\u001B[39m object 'Residuals' not found\nBacktrace:\n\u001B[90m  1. \u001B[39m\u001B[1mbase\u001B[22m::print(plot_homogeneity)\n\u001B[90m  2. \u001B[39mggplot2:::print.ggplot(plot_homogeneity)\n\u001B[90m  4. \u001B[39mggplot2:::ggplot_build.ggplot(x)\n\u001B[90m  5. \u001B[39mggplot2:::by_layer(...)\n\u001B[90m 12. \u001B[39mggplot2 (local) f(l = layers[[i]], d = data[[i]])\n\u001B[90m 13. \u001B[39ml$compute_aesthetics(d, plot)\n\u001B[90m 14. \u001B[39mggplot2 (local) compute_aesthetics(..., self = self)\n\u001B[90m 15. \u001B[39mggplot2:::scales_add_defaults(...)\n\u001B[90m 16. \u001B[39m\u001B[1mbase\u001B[22m::lapply(aesthetics[new_aesthetics], eval_tidy, data = data)\n\u001B[90m 17. \u001B[39m\u001B[1mrlang\u001B[22m (local) FUN(X[[i]], ...)\n",
        "> ",
        "qq_plot <- qqnorm(resid(S1_anova_results), main = \"Normal Q-Q Plot of Residuals\")",
        "Error in qqnorm.default(resid(S1_anova_results), main = \"Normal Q-Q Plot of Residuals\") : \n  y is empty or has only NAs\n",
        "> ",
        "",
        "> ",
        "#Subset the question",
        "> ",
        "",
        "> ",
        "S1_subset_data <- filter(Satiety_long, Question == \"S1\")",
        "> ",
        "",
        "> ",
        "# 2 way ANOVA",
        "> ",
        "",
        "> ",
        "S1_anova_results <- aov(Measurement ~ Intervention * Timepoint + Error(Participant/Timepoint), data = S1_subset_data)",
        "> ",
        "",
        "> ",
        "print(summary(S1_anova_results))",
        "\nError: Participant\n          Df Sum Sq Mean Sq F value Pr(>F)\nResiduals 38 217193    5716               \n\nError: Participant:Timepoint\n           Df Sum Sq Mean Sq F value Pr(>F)    \nTimepoint  10 210890   21089   76.06 <2e-16 ***\nResiduals 380 105368     277                   \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nError: Within\n                        Df Sum Sq Mean Sq F value Pr(>F)    \nIntervention             1  16945   16945   80.87 <2e-16 ***\nIntervention:Timepoint",
        "  10   1886     189    0.90  0.533    \nResiduals              418  87583     210                   \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n",
        "> ",
        "",
        "> ",
        "leveneTest(Measurement ~ Intervention * Timepoint, data = S1_subset_data)",
        "Levene's Test for Homogeneity of Variance (center = median)\n       Df F value Pr(>F)\ngroup  21  1.1252 0.3146\n      836               \n",
        "> ",
        "",
        "> ",
        "shapiro.test(resid(S1_anova_results))",
        "Error in shapiro.test(resid(S1_anova_results)) : \n  is.numeric(x) is not TRUE\n",
        "> ",
        "leveneTest(Measurement ~ Intervention * Timepoint, data = S1_subset_data)",
        "Levene's Test for Homogeneity of Variance (center = median)\n       Df F value Pr(>F)\ngroup  21  1.1252 0.3146\n      836               \n",
        "> ",
        "",
        "> ",
        "plot_homogeneity <- ggplot(data.frame(Residuals = resid(S1_anova_results)), aes(y = Residuals)) +",
        "+ ",
        "  geom_boxplot() +",
        "+ ",
        "  labs(title = \"Homogeneity of Variances\", y = \"Residuals\") +",
        "+ ",
        "  theme_minimal()",
        "> ",
        "print(plot_homogeneity)",
        "\u001B[1m\u001B[33mError\u001B[39m in `geom_boxplot()`:\u001B[22m\n\u001B[38;5;232m\u001B[33m!\u001B[38;5;232m Problem while computing aesthetics.\n\u001B[36mℹ\u001B[38;5;232m Error occurred in the 1st layer.\u001B[39m\n\u001B[1mCaused by error:\u001B[22m\n\u001B[33m!\u001B[39m object 'Residuals' not found\nBacktrace:\n\u001B[90m  1. \u001B[39m\u001B[1mbase\u001B[22m::print(plot_homogeneity)\n\u001B[90m  2. \u001B[39mggplot2:::print.ggplot(plot_homogeneity)\n\u001B[90m  4. \u001B[39mggplot2:::ggplot_build.ggplot(x)\n\u001B[90m  5. \u001B[39mggplot2:::by_layer(...)\n\u001B[90m 12. \u001B[39mggplot2 (local) f(l = layers[[i]], d = data[[i]])\n\u001B[90m 13. \u001B[39ml$compute_aesthetics(d, plot)\n\u001B[90m 14. \u001B[39mggplot2 (local) compute_aesthetics(..., self = self)\n\u001B[90m 15. \u001B[39mggplot2:::scales_add_defaults(...)\n\u001B[90m 16. \u001B[39m\u001B[1mbase\u001B[22m::lapply(aesthetics[new_aesthetics], eval_tidy, data = data)\n\u001B[90m 17. \u001B[39m\u001B[1mrlang\u001B[22m (local) FUN(X[[i]], ...)\n",
        "> ",
        "View(anova_results_S1)",
        "> ",
        "library(readxl)",
        "> ",
        "library(tidyverse)",
        "> ",
        "library(patchwork)",
        "> ",
        "library(hrbrthemes)",
        "> ",
        "library(DT)",
        "> ",
        "library(knitr)",
        "> ",
        "library(plotly)",
        "> ",
        "library(tidyr)",
        "> ",
        "library(dplyr)",
        "> ",
        "library(car)",
        "> ",
        "# Read the cleaned Satiety Study",
        "> ",
        "",
        "> ",
        "Satiety <- read_excel(\"../Input/HUEL_satiety_input.xlsx\")",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "#load function",
        "> ",
        "source(file = \"../R/HUEL_satiety_functions.R\")",
        "> ",
        "",
        "> ",
        "# Create an interactive table",
        "> ",
        "",
        "> ",
        "datatable(Satiety, filter = \"top\")",
        "> ",
        "",
        "> ",
        "# create mean +- SD table for HUEL and Cornflakes S1, 0 to 240 minutes",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "result_huel_s1 <- calculate_mean_sd(Satiety, intervention = \"HUEL\", question = \"S1\")",
        "> ",
        "result_cornflakes_s1 <- calculate_mean_sd(Satiety, intervention = \"Cornflakes\", question = \"S1\")",
        "> ",
        "",
        "> ",
        "combine_and_display_results(result_huel_s1, result_cornflakes_s1)",
        "> ",
        "",
        "> ",
        "# create a long format",
        "> ",
        "",
        "> ",
        "Satiety_long <- Satiety %>%",
        "+ ",
        "    pivot_longer(cols = starts_with(\"HUEL_\") | starts_with(\"Cornflakes_\"), names_to = \"Timepoint\", values_to = \"Measurement\")",
        "> ",
        "",
        "> ",
        "# Create Intervention column based on Timepoint",
        "> ",
        "Satiety_long <- Satiety_long %>%",
        "+ ",
        "  mutate(Intervention = ifelse(str_detect(Timepoint, \"^HUEL\"), \"HUEL\", \"Cornflakes\"),",
        "+ ",
        "         Timepoint = gsub(\"^HUEL_|^Cornflakes_\", \"\", Timepoint),",
        "+ ",
        "         Question = gsub(\"_.*\", \"\", Timepoint),",
        "+ ",
        "         Timepoint = gsub(\"^S\\\\d+_\", \"\", Timepoint))",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "#Subset the question",
        "> ",
        "",
        "> ",
        "S1_subset_data <- filter(Satiety_long, Question == \"S1\")",
        "> ",
        "",
        "> ",
        "# 2 way ANOVA",
        "> ",
        "",
        "> ",
        "S1_anova_results <- aov(Measurement ~ Intervention * Timepoint + Error(Participant/Timepoint), data = S1_subset_data)",
        "> ",
        "",
        "> ",
        "print(summary(S1_anova_results))",
        "\nError: Participant\n          Df Sum Sq Mean Sq F value Pr(>F)\nResiduals 38 217193    5716               \n\nError: Participant:Timepoint\n           Df Sum Sq Mean Sq F value Pr(>F)    \nTimepoint  10 210890   21089   76.06 <2e-16 ***\nResiduals 380 105368     277                   \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nError: Within\n                        Df Sum Sq Mean Sq F value Pr(>F)    \nIntervention             1  16945   16945   80.87 <2e-16 ***\nIntervention:Timepoint",
        "  10   1886     189    0.90  0.533    \nResiduals              418  87583     210                   \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "#| layout-ncol: 2",
        "> ",
        "",
        "> ",
        "#Check assumptions",
        "> ",
        "",
        "> ",
        "leveneTest(Measurement ~ Intervention * Timepoint, data = S1_subset_data)",
        "Levene's Test for Homogeneity of Variance (center = median)\n       Df F value Pr(>F)\ngroup  21  1.1252 0.3146\n      836               \n",
        "> ",
        "",
        "> ",
        "plot_homogeneity <- ggplot(data.frame(Residuals = resid(S1_anova_results)), aes(y = Residuals)) +",
        "+ ",
        "  geom_boxplot() +",
        "+ ",
        "  labs(title = \"Homogeneity of Variances\", y = \"Residuals\") +",
        "+ ",
        "  theme_minimal()",
        "> ",
        "print(plot_homogeneity)",
        "\u001B[1m\u001B[33mError\u001B[39m in `geom_boxplot()`:\u001B[22m\n\u001B[38;5;232m\u001B[33m!\u001B[38;5;232m Problem while computing aesthetics.\n\u001B[36mℹ\u001B[38;5;232m Error occurred in the 1st layer.\u001B[39m\n\u001B[1mCaused by error:\u001B[22m\n\u001B[33m!\u001B[39m object 'Residuals' not found\nBacktrace:\n\u001B[90m  1. \u001B[39m\u001B[1mbase\u001B[22m::print(plot_homogeneity)\n\u001B[90m  2. \u001B[39mggplot2:::print.ggplot(plot_homogeneity)\n\u001B[90m  4. \u001B[39mggplot2:::ggplot_build.ggplot(x)\n\u001B[90m  5. \u001B[39mggplot2:::by_layer(...)\n\u001B[90m 12. \u001B[39mggplot2 (local) f(l = layers[[i]], d = data[[i]])\n\u001B[90m 13. \u001B[39ml$compute_aesthetics(d, plot)\n\u001B[90m 14. \u001B[39mggplot2 (local) compute_aesthetics(..., self = self)\n\u001B[90m 15. \u001B[39mggplot2:::scales_add_defaults(...)\n\u001B[90m 16. \u001B[39m\u001B[1mbase\u001B[22m::lapply(aesthetics[new_aesthetics], eval_tidy, data = data)\n\u001B[90m 17. \u001B[39m\u001B[1mrlang\u001B[22m (local) FUN(X[[i]], ...)\n",
        "> ",
        "",
        "> ",
        "S1_anova_results <- aov(Measurement ~ Intervention * Timepoint + Error(Participant/Timepoint), data = S1_subset_data)",
        "> ",
        "# Store residuals in the ANOVA results object",
        "> ",
        "S1_anova_results$residuals <- resid(S1_anova_results)",
        "> ",
        "",
        "> ",
        "print(summary(S1_anova_results))",
        "\nError: Participant\n          Df Sum Sq Mean Sq F value Pr(>F)\nResiduals 38 217193    5716               \n\nError: Participant:Timepoint\n           Df Sum Sq Mean Sq F value Pr(>F)    \nTimepoint  10 210890   21089   76.06 <2e-16 ***\nResiduals 380 105368     277                   \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nError: Within\n                        Df Sum Sq Mean Sq F value Pr(>F)    \nIntervention             1  16945   16945   80.87 <2e-16 ***\nIntervention:Timepoint",
        "  10   1886     189    0.90  0.533    \nResiduals              418  87583     210                   \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n",
        "> ",
        "",
        "> ",
        "#| layout-ncol: 2",
        "> ",
        "",
        "> ",
        "#Check assumptions",
        "> ",
        "",
        "> ",
        "leveneTest(Measurement ~ Intervention * Timepoint, data = S1_subset_data)",
        "Levene's Test for Homogeneity of Variance (center = median)\n       Df F value Pr(>F)\ngroup  21  1.1252 0.3146\n      836               \n",
        "> ",
        "",
        "> ",
        "plot_homogeneity <- ggplot(data.frame(Residuals = resid(S1_anova_results)), aes(y = Residuals)) +",
        "+ ",
        "  geom_boxplot() +",
        "+ ",
        "  labs(title = \"Homogeneity of Variances\", y = \"Residuals\") +",
        "+ ",
        "  theme_minimal()",
        "> ",
        "print(plot_homogeneity)",
        "\u001B[1m\u001B[33mError\u001B[39m in `geom_boxplot()`:\u001B[22m\n\u001B[38;5;232m\u001B[33m!\u001B[38;5;232m Problem while computing aesthetics.\n\u001B[36mℹ\u001B[38;5;232m Error occurred in the 1st layer.\u001B[39m\n\u001B[1mCaused by error:\u001B[22m\n\u001B[33m!\u001B[39m object 'Residuals' not found\nBacktrace:\n\u001B[90m  1. \u001B[39m\u001B[1mbase\u001B[22m::print(plot_homogeneity)\n\u001B[90m  2. \u001B[39mggplot2:::print.ggplot(plot_homogeneity)\n\u001B[90m  4. \u001B[39mggplot2:::ggplot_build.ggplot(x)\n\u001B[90m  5. \u001B[39mggplot2:::by_layer(...)\n\u001B[90m 12. \u001B[39mggplot2 (local) f(l = layers[[i]], d = data[[i]])\n\u001B[90m 13. \u001B[39ml$compute_aesthetics(d, plot)\n\u001B[90m 14. \u001B[39mggplot2 (local) compute_aesthetics(..., self = self)\n\u001B[90m 15. \u001B[39mggplot2:::scales_add_defaults(...)\n\u001B[90m 16. \u001B[39m\u001B[1mbase\u001B[22m::lapply(aesthetics[new_aesthetics], eval_tidy, data = data)\n\u001B[90m 17. \u001B[39m\u001B[1mrlang\u001B[22m (local) FUN(X[[i]], ...)\n",
        "> ",
        "View(S1_anova_results)",
        "> ",
        "residuals <- residuals(S1_anova_results)",
        "> ",
        "",
        "> ",
        "S1_anova_results <- aov(Measurement ~ Intervention * Timepoint + Error(Participant/Timepoint), data = S1_subset_data)",
        "> ",
        "",
        "> ",
        "residuals <- residuals(S1_anova_results)",
        "> ",
        "",
        "> ",
        "plot_homogeneity <- ggplot(data.frame(Residuals = residuals), aes(y = Residuals)) +",
        "+ ",
        "  geom_boxplot() +",
        "+ ",
        "  labs(title = \"Homogeneity of Variances\", y = \"Residuals\") +",
        "+ ",
        "  theme_minimal()",
        "> ",
        "",
        "> ",
        "print(plot_homogeneity)",
        "\u001B[1m\u001B[33mError\u001B[39m in `geom_boxplot()`:\u001B[22m\n\u001B[38;5;232m\u001B[33m!\u001B[38;5;232m Problem while computing aesthetics.\n\u001B[36mℹ\u001B[38;5;232m Error occurred in the 1st layer.\u001B[39m\n\u001B[1mCaused by error:\u001B[22m\n\u001B[33m!\u001B[39m object 'Residuals' not found\nBacktrace:\n\u001B[90m  1. \u001B[39m\u001B[1mbase\u001B[22m::print(plot_homogeneity)\n\u001B[90m  2. \u001B[39mggplot2:::print.ggplot(plot_homogeneity)\n\u001B[90m  4. \u001B[39mggplot2:::ggplot_build.ggplot(x)\n\u001B[90m  5. \u001B[39mggplot2:::by_layer(...)\n\u001B[90m 12. \u001B[39mggplot2 (local) f(l = layers[[i]], d = data[[i]])\n\u001B[90m 13. \u001B[39ml$compute_aesthetics(d, plot)\n\u001B[90m 14. \u001B[39mggplot2 (local) compute_aesthetics(..., self = self)\n\u001B[90m 15. \u001B[39mggplot2:::scales_add_defaults(...)\n\u001B[90m 16. \u001B[39m\u001B[1mbase\u001B[22m::lapply(aesthetics[new_aesthetics], eval_tidy, data = data)\n\u001B[90m 17. \u001B[39m\u001B[1mrlang\u001B[22m (local) FUN(X[[i]], ...)\n",
        "> ",
        "",
        "> ",
        "#Subset the question",
        "> ",
        "",
        "> ",
        "S1_subset_data <- filter(Satiety_long, Question == \"S1\")",
        "> ",
        "",
        "> ",
        "# 2 way ANOVA",
        "> ",
        "",
        "> ",
        "S1_anova_results <- aov(Measurement ~ Intervention * Timepoint + Error(Participant/Timepoint), data = S1_subset_data)",
        "> ",
        "",
        "> ",
        "residuals <- residuals(S1_anova_results)",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "print(summary(S1_anova_results))",
        "\nError: Participant\n          Df Sum Sq Mean Sq F value Pr(>F)\nResiduals 38 217193    5716               \n\nError: Participant:Timepoint\n           Df Sum Sq Mean Sq F value Pr(>F)    \nTimepoint  10 210890   21089   76.06 <2e-16 ***\nResiduals 380 105368     277                   \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nError: Within\n                        Df Sum Sq Mean Sq F value Pr(>F)    \nIntervention             1  16945   16945   80.87 <2e-16 ***\nIntervention:Timepoint",
        "  10   1886     189    0.90  0.533    \nResiduals              418  87583     210                   \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "#Subset the question",
        "> ",
        "",
        "> ",
        "S1_subset_data <- filter(Satiety_long, Question == \"S1\")",
        "> ",
        "",
        "> ",
        "# 2 way ANOVA",
        "> ",
        "",
        "> ",
        "S1_anova_results <- aov(Measurement ~ Intervention * Timepoint, data = S1_subset_data)",
        "> ",
        "",
        "> ",
        "residuals <- residuals(S1_anova_results)",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "print(summary(S1_anova_results))",
        "                        Df Sum Sq Mean Sq F value   Pr(>F)    \nIntervention             1  16945   16945  34.540 6.03e-09 ***\nTimepoint               10 210890   21089  42.986  < 2e-16 ***\nIntervention:Timepoint  10   1886     189   0.384    0.954    \nResiduals              836 410144     491                     \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n22 observations deleted due to missingness\n",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "#| layout-ncol: 2",
        "> ",
        "",
        "> ",
        "#Check assumptions",
        "> ",
        "",
        "> ",
        "leveneTest(Measurement ~ Intervention * Timepoint, data = S1_subset_data)",
        "Levene's Test for Homogeneity of Variance (center = median)\n       Df F value Pr(>F)\ngroup  21  1.1252 0.3146\n      836               \n",
        "> ",
        "",
        "> ",
        "plot_homogeneity <- ggplot(data.frame(Residuals = resid(S1_anova_results)), aes(y = Residuals)) +",
        "+ ",
        "  geom_boxplot() +",
        "+ ",
        "  labs(title = \"Homogeneity of Variances\", y = \"Residuals\") +",
        "+ ",
        "  theme_minimal()",
        "> ",
        "print(plot_homogeneity)",
        "> ",
        "",
        "> ",
        "qq_plot <- qqnorm(resid(S1_anova_results), main = \"Normal Q-Q Plot of Residuals\")",
        "> ",
        "qq_line <- qqline(resid(S1_anova_results))",
        "> ",
        "",
        "> ",
        "shapiro.test(resid(S1_anova_results))",
        "\n\tShapiro-Wilk normality test\n\ndata:  resid(S1_anova_results)\nW = 0.9928, p-value = 0.0003635\n\n",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "#Subset the question",
        "> ",
        "",
        "> ",
        "S1_subset_data <- filter(Satiety_long, Question == \"S1\")",
        "> ",
        "",
        "> ",
        "# 2 way ANOVA",
        "> ",
        "",
        "> ",
        "S1_anova_results <- aov(Measurement ~ Intervention * Timepoint + Error(Participant), data = S1_subset_data)",
        "> ",
        "",
        "> ",
        "residuals <- residuals(S1_anova_results)",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "print(summary(S1_anova_results))",
        "\nError: Participant\n          Df Sum Sq Mean Sq F value Pr(>F)\nResiduals 38 217193    5716               \n\nError: Within\n                        Df Sum Sq Mean Sq F value   Pr(>F)    \nIntervention             1  16945   16945   70.08 2.54e-16 ***\nTimepoint               10 210890   21089   87.22  < 2e-16 ***\nIntervention:Timepoint  10   1886     189    0.78    0.648    \nResiduals              798 192951     242                     \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1",
        "\n",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "#Subset the question",
        "> ",
        "",
        "> ",
        "S1_subset_data <- filter(Satiety_long, Question == \"S1\")",
        "> ",
        "",
        "> ",
        "# 2 way ANOVA",
        "> ",
        "",
        "> ",
        "S1_anova_results <- aov(Measurement ~ Intervention * Timepoint, data = S1_subset_data)",
        "> ",
        "",
        "> ",
        "residuals <- residuals(S1_anova_results)",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "print(summary(S1_anova_results))",
        "                        Df Sum Sq Mean Sq F value   Pr(>F)    \nIntervention             1  16945   16945  34.540 6.03e-09 ***\nTimepoint               10 210890   21089  42.986  < 2e-16 ***\nIntervention:Timepoint  10   1886     189   0.384    0.954    \nResiduals              836 410144     491                     \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n22 observations deleted due to missingness\n",
        "> ",
        "",
        "> ",
        "View(S1_subset_data)",
        "> ",
        "library(readxl)",
        "> ",
        "library(tidyverse)",
        "> ",
        "library(patchwork)",
        "> ",
        "library(hrbrthemes)",
        "> ",
        "library(DT)",
        "> ",
        "library(knitr)",
        "> ",
        "library(plotly)",
        "> ",
        "library(tidyr)",
        "> ",
        "library(dplyr)",
        "> ",
        "library(car)",
        "> ",
        "# Read the cleaned Satiety Study",
        "> ",
        "",
        "> ",
        "Satiety <- read_excel(\"../Input/HUEL_satiety_input.xlsx\")",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "#load function",
        "> ",
        "source(file = \"../R/HUEL_satiety_functions.R\")",
        "> ",
        "",
        "> ",
        "# Create an interactive table",
        "> ",
        "",
        "> ",
        "datatable(Satiety, filter = \"top\")",
        "> ",
        "",
        "> ",
        "# create mean +- SD table for HUEL and Cornflakes S1, 0 to 240 minutes",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "result_huel_s1 <- calculate_mean_sd(Satiety, intervention = \"HUEL\", question = \"S1\")",
        "> ",
        "result_cornflakes_s1 <- calculate_mean_sd(Satiety, intervention = \"Cornflakes\", question = \"S1\")",
        "> ",
        "",
        "> ",
        "combine_and_display_results(result_huel_s1, result_cornflakes_s1)",
        "> ",
        "",
        "> ",
        "# create a long format",
        "> ",
        "",
        "> ",
        "Satiety_long <- Satiety %>%",
        "+ ",
        "    pivot_longer(cols = starts_with(\"HUEL_\") | starts_with(\"Cornflakes_\"), names_to = \"Timepoint\", values_to = \"Measurement\")",
        "> ",
        "",
        "> ",
        "# Create Intervention column based on Timepoint",
        "> ",
        "Satiety_long <- Satiety_long %>%",
        "+ ",
        "  mutate(Intervention = ifelse(str_detect(Timepoint, \"^HUEL\"), \"HUEL\", \"Cornflakes\"),",
        "+ ",
        "         Timepoint = gsub(\"^HUEL_|^Cornflakes_\", \"\", Timepoint),",
        "+ ",
        "         Question = gsub(\"_.*\", \"\", Timepoint),",
        "+ ",
        "         Timepoint = gsub(\"^S\\\\d+_\", \"\", Timepoint))",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "#Subset the question",
        "> ",
        "",
        "> ",
        "S1_subset_data <- filter(Satiety_long, Question == \"S1\")",
        "> ",
        "",
        "> ",
        "# 2 way ANOVA",
        "> ",
        "",
        "> ",
        "S1_anova_results <- aov(Measurement ~ Intervention * Timepoint + Error(Participant/Timepoint), data = S1_subset_data)",
        "> ",
        "",
        "> ",
        "residuals <- residuals(S1_anova_results)",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "print(summary(S1_anova_results))",
        "\nError: Participant\n          Df Sum Sq Mean Sq F value Pr(>F)\nResiduals 38 217193    5716               \n\nError: Participant:Timepoint\n           Df Sum Sq Mean Sq F value Pr(>F)    \nTimepoint  10 210890   21089   76.06 <2e-16 ***\nResiduals 380 105368     277                   \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\nError: Within\n                        Df Sum Sq Mean Sq F value Pr(>F)    \nIntervention             1  16945   16945   80.87 <2e-16 ***\nIntervention:Timepoint",
        "  10   1886     189    0.90  0.533    \nResiduals              418  87583     210                   \n---\nSignif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n",
        "> ",
        "",
        "> ",
        "",
        "> ",
        "#| layout-ncol: 2",
        "> ",
        "",
        "> ",
        "#Check assumptions",
        "> ",
        "",
        "> ",
        "leveneTest(Measurement ~ Intervention * Timepoint, data = S1_subset_data)",
        "Levene's Test for Homogeneity of Variance (center = median)\n       Df F value Pr(>F)\ngroup  21  1.1252 0.3146\n      836               \n",
        "> ",
        "",
        "> ",
        "plot_homogeneity <- ggplot(data.frame(Residuals = resid(S1_anova_results)), aes(y = Residuals)) +",
        "+ ",
        "  geom_boxplot() +",
        "+ ",
        "  labs(title = \"Homogeneity of Variances\", y = \"Residuals\") +",
        "+ ",
        "  theme_minimal()",
        "> ",
        "print(plot_homogeneity)",
        "\u001B[1m\u001B[33mError\u001B[39m in `geom_boxplot()`:\u001B[22m\n\u001B[38;5;232m\u001B[33m!\u001B[38;5;232m Problem while computing aesthetics.\n\u001B[36mℹ\u001B[38;5;232m Error occurred in the 1st layer.\u001B[39m\n\u001B[1mCaused by error:\u001B[22m\n\u001B[33m!\u001B[39m object 'Residuals' not found\nBacktrace:\n\u001B[90m  1. \u001B[39m\u001B[1mbase\u001B[22m::print(plot_homogeneity)\n\u001B[90m  2. \u001B[39mggplot2:::print.ggplot(plot_homogeneity)\n\u001B[90m  4. \u001B[39mggplot2:::ggplot_build.ggplot(x)\n\u001B[90m  5. \u001B[39mggplot2:::by_layer(...)\n\u001B[90m 12. \u001B[39mggplot2 (local) f(l = layers[[i]], d = data[[i]])\n\u001B[90m 13. \u001B[39ml$compute_aesthetics(d, plot)\n\u001B[90m 14. \u001B[39mggplot2 (local) compute_aesthetics(..., self = self)\n\u001B[90m 15. \u001B[39mggplot2:::scales_add_defaults(...)\n\u001B[90m 16. \u001B[39m\u001B[1mbase\u001B[22m::lapply(aesthetics[new_aesthetics], eval_tidy, data = data)\n\u001B[90m 17. \u001B[39m\u001B[1mrlang\u001B[22m (local) FUN(X[[i]], ...)\n",
        "\nRestarting R session...\n\n"
    ]
}